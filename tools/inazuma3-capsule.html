<!DOCTYPE html>
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>イナズマ3 ガチャ</title>
<script type="text/javascript" src="myutil.js?20100903"></script>
<script type="text/javascript">

var CAPSULE_UNIT_DATA = [
[
[["あしつ", 2], ["あずま", 0], ["いけす", 1], ["いさりび", 1], ["いんべ", 0], ["うけがわ", 1], ["エコ", 2], ["おおさか", 1], ["おおたに", 0], ["おかやま", 1], ["おとながい", 0], ["かいどう", 1], ["かさはら", 2], ["かぶと", 2], ["カプリコ", 0], ["くにさだ", 2], ["くれん", 1], ["こひら", 1], ["ざしき", 2], ["しーちゃん", 0], ["ジェット", 0], ["しながわ", 1], ["しょうめい", 1], ["しらさぎ", 2], ["しらな", 1], ["しらべ", 2], ["すえたけ", 1], ["すわ", 0], ["タエミー", 0], ["たがしら", 0], ["ちかい", 2], ["ながつき", 2], ["ながれ", 1], ["なつか", 0], ["にへい", 1], ["ぬまぐち", 1], ["ぬりかべ", 2], ["のべくん", 0], ["ハシ", 2], ["はしもと", 0], ["はりやま", 0], ["ハルドラ", 0], ["ひかげ", 1], ["ひゅうが", 0], ["フォース", 0], ["ふかわ", 2], ["プロモ", 0], ["ほうれん", 1], ["ほとけ", 2], ["まつばら", 0], ["みやさか", 0], ["ムラーベ", 0], ["やまもと", 0], ["やわら", 1], ["よこみち", 2], ["よろい", 2], ["リボン", 0], ["れっぷう", 2], ["ワジ", 0], ["わだ", 2]],
[["あいぞめ", 1], ["あかひこ", 1], ["あまほ", 0], ["いがらし", 2], ["いちはた", 0], ["いまい", 0], ["いわき", 0], ["エツオー", 0], ["えもと", 0], ["おおいた", 2], ["おおわき", 0], ["おぎ", 1], ["かいほう", 2], ["がり", 2], ["かんう", 2], ["きょうと", 1], ["くさか", 1], ["くさなぎ", 2], ["ごくう", 1], ["こだま", 1], ["こばやし", 1], ["サイヒーロ", 0], ["サザレ", 0], ["しょう", 1], ["しろま", 2], ["しろわし", 2], ["シンタ", 2], ["たかおか", 1], ["たきざわ", 1], ["チェアマン", 0], ["つなもり", 0], ["てつやま", 1], ["てるよし", 1], ["ドウ", 0], ["なべ", 2], ["ノザック", 0], ["はやつ", 0], ["ひむろ", 2], ["ふかみち", 1], ["ふしき", 2], ["ぽんた", 2], ["まきぐち", 0], ["みえ", 1], ["みずまき", 2], ["みつき", 0], ["もず", 1], ["モチコー", 0], ["やえがし", 2], ["やまがみ", 0], ["やまなし", 2], ["よこはま", 2], ["らいか", 2], ["ロボット", 0]],
[["あゆむ", 1], ["いしどう", 0], ["いちご", 2], ["いっとく", 0], ["いまだ", 1], ["うまじ", 2], ["おおにわ", 1], ["おおわだ", 0], ["かいよう", 1], ["かが", 2], ["かがわ", 2], ["かんの", 0], ["けご", 0], ["ごうゆう", 2], ["コーヘー", 0], ["サエッキー", 0], ["さが", 1], ["ささ", 0], ["ささもと", 2], ["さだお", 1], ["すなお", 2], ["すなかわ", 1], ["すみ", 0], ["そうだん", 2], ["タキオー", 2], ["たちきり", 0], ["ちゃやま", 1], ["てらい", 1], ["なかいずみ", 1], ["ながさき", 2], ["ながら", 0], ["ながる", 2], ["ナッシー", 0], ["ノダッタ", 0], ["はなにわ", 2], ["はりつじ", 1], ["はるの", 2], ["ふき", 0], ["ふきいし", 1], ["まいたに", 1], ["まつむら", 0], ["まの", 1], ["みずわたり", 2], ["みなもと", 2], ["むかいの", 1], ["むつ", 2], ["モデラー", 1], ["もりばやし", 1], ["ユイリー", 0], ["ユウキィ", 0], ["よこた", 1]]
], [
[["あさつゆ", 2], ["おおひさ", 2], ["おがみ", 0], ["キャプ", 0], ["さえか", 2], ["たどころ", 0], ["だん", 2], ["でんこう", 2], ["とくしゅ", 0], ["なんりく", 2], ["ニーナ", 1], ["にほら", 0], ["ひつじ", 0], ["ふるやま", 1], ["ほそや", 0], ["まぁ", 0], ["みーや", 0], ["みかん", 0], ["みやざき", 2], ["やまにし", 1]],
[["あしだ", 1], ["アバヤ", 2], ["おとした", 2], ["かいづか", 0], ["カモノハシ", 0], ["かわせ", 0], ["クロブタ", 0], ["しっぷう", 0], ["そらはら", 2], ["だいこく", 2], ["たかすぎ", 2], ["たぐち", 0], ["てづくり", 1], ["とうか", 0], ["のざわ", 0], ["ピーチッチ", 0], ["ひろしま", 2], ["めいきょう", 1], ["やまむら", 1], ["りしゃこ", 0]],
[["あかだい", 1], ["いりき", 2], ["かざむかい", 2], ["こやま", 1], ["さこた", 0], ["じゅうじ", 2], ["ジュネ", 1], ["そしき", 0], ["ターバン", 0], ["タジン", 0], ["ちーちゃん", 0], ["つや", 0], ["とみやま", 0], ["ねっけつ", 0], ["はやし", 2], ["ふくろぐま", 0], ["やまぐち", 2], ["ゆりな", 0], ["りゅうぞう", 1], ["りゅうの", 2], ["わらし", 0]]
], [
[["いまむら", 1], ["ぐれい", 1], ["コロ", 2], ["さだ", 0], ["しもつき", 2], ["たお", 0], ["たかやなぎ", 0], ["ちょうひ", 2], ["ときお", 0], ["なみむら", 1], ["ぬのむら", 2], ["ばんや", 0], ["ひらが", 0], ["ふくだ", 0], ["ふじた", 0], ["まみや", 2], ["メロン", 2], ["ロング", 2]],
[["いぐち", 2], ["おおつき", 0], ["おおば", 0], ["かいず", 2], ["かいり", 0], ["かまきり", 2], ["かむい", 0], ["きじま", 0], ["シバレル", 2], ["しまね", 1], ["そだ", 2], ["そめみや", 0], ["てんとう", 2], ["とくい", 1], ["とよとみ", 1], ["ますだ", 0]],
[["あが", 2], ["いすな", 1], ["オール", 2], ["かつ", 2], ["きりあや", 2], ["こうち", 0], ["たかお", 1], ["たけたに", 2], ["のぐち", 0], ["ふじさき", 0], ["まいたん", 2], ["みむら", 1], ["もりした", 2], ["やすもり", 0], ["ゆいこ", 0]]
], [
[["あおい", 0], ["あおそり", 0], ["いがた", 1], ["いき", 0], ["いけだ", 0], ["いわなり", 0], ["えいようし", 1], ["かげろう", 1], ["かたはた", 1], ["かつまた", 2], ["カナル", 2], ["かも", 2], ["くげ", 1], ["くりばやし", 1], ["くるるん", 2], ["くれの", 0], ["くろかわ", 1], ["こんどう", 1], ["サイバン", 0], ["しぎょう", 0], ["しなの", 2], ["じょうぎ", 2], ["しょうづ", 2], ["しょうとく", 1], ["せきえい", 1], ["たぢから", 1], ["たむら", 0], ["にしお", 1], ["はくおう", 2], ["はじめ", 2], ["ひびはら", 1], ["ピンクＤ", 2], ["ピンクＳ", 2], ["ブルー", 2], ["ヘッドホン", 0], ["ほりたか", 1], ["みずかみ", 0], ["みやまる", 0], ["みろく", 1], ["もりひさ", 1], ["もんま", 0], ["やくしじ", 2], ["やまみち", 0], ["るい", 1], ["レッドＳ", 2]],
[["あかぎり", 0], ["あたご", 2], ["あつい", 1], ["イエローＳ", 2], ["インカン", 1], ["おおだこ", 0], ["おおや", 1], ["おそれやま", 1], ["かじま", 0], ["かなえ", 0], ["かはく", 1], ["かひら", 1], ["かまい", 2], ["きみなみ", 2], ["グリーンＳ", 2], ["こうてつ", 1], ["ことぶき", 0], ["こんごう", 2], ["さいごう", 2], ["さつき", 1], ["さんぽ", 1], ["シカ", 0], ["すけまつ", 0], ["せいぶ", 0], ["だいきち", 1], ["つげ", 2], ["ときか", 0], ["なかぞの", 0], ["ナッキー", 0], ["にじの", 1], ["にのみや", 1], ["のぞみ", 0], ["はいじま", 1], ["はたの", 2], ["ピンク", 2], ["プラチナ", 0], ["ブルーＤ", 2], ["ほうば", 2], ["ほっかい", 1], ["みどりかわ", 1], ["よしくに", 2], ["らいでん", 1], ["レッドＤ", 2]],
[["あきた", 1], ["あしゅら", 1], ["あそ", 1], ["あわしま", 2], ["イエロー", 2], ["イエローＤ", 2], ["いなご", 0], ["うえの", 0], ["うべ", 0], ["うみはら", 0], ["うんの", 1], ["えばた", 1], ["かいとう", 2], ["かない", 1], ["かなや", 0], ["かまど", 1], ["きたがた", 0], ["くらもち", 0], ["グリーンＤ", 2], ["こじか", 0], ["ざいほう", 2], ["さわだ", 0], ["しとう", 2], ["しゃらく", 2], ["しゅうほう", 2], ["しらいし", 1], ["しんご", 1], ["しんたく", 0], ["すえの", 1], ["たまみ", 0], ["てんしょう", 2], ["なわて", 1], ["ネック", 0], ["はにわ", 1], ["ひやま", 1], ["ふうこ", 0], ["ふらの", 2], ["ブルーＳ", 2], ["ふるや", 1], ["ほそえ", 1], ["みどりまげ", 0], ["ももたろう", 1], ["ゆげ", 2], ["レッド", 2]]
], [
[["うちざき", 1], ["うまみ", 2], ["エビ", 1], ["かいおう", 2], ["きわみち", 1], ["すばる", 2], ["すみみち", 1], ["ちあさ", 0], ["トンニーノ", 2], ["のばやし", 0], ["はぶ", 2], ["ふなやま", 2], ["まちの", 1], ["まなか", 0], ["まなせ", 0], ["まに", 1], ["まんげつ", 2], ["みきた", 1], ["みたま", 1], ["むらやま", 0], ["よしだ", 0], ["レポ", 1], ["れんだい", 0]],
[["あおば", 1], ["うみわたり", 2], ["エビリーナ", 0], ["おだ", 1], ["かさやま", 2], ["こぐるま", 2], ["こんじき", 0], ["さく", 0], ["しきな", 0], ["しげの", 2], ["じゅうべえ", 2], ["すずな", 0], ["チキータ", 2], ["てざき", 1], ["どうりき", 1], ["とくがわ", 2], ["ともちゃん", 0], ["にし", 1], ["ばとう", 1], ["はなもと", 0], ["ヒデ", 0], ["ヒロシ", 1], ["ふなだ", 1], ["ほそみち", 1], ["めぐろ", 0], ["もんじゅ", 2]],
[["あまぼし", 0], ["いしまつ", 2], ["うみさき", 1], ["エイ", 1], ["えじま", 1], ["おけたに", 2], ["かじ", 0], ["かしん", 1], ["かぶらぎ", 2], ["かんべ", 2], ["くぎや", 0], ["こてがわ", 2], ["ささき", 1], ["たかさき", 0], ["たけだ", 2], ["たなか", 1], ["たにむら", 1], ["ついざき", 1], ["どうがみ", 0], ["ほうじょう", 0], ["みずくさ", 1], ["みやち", 1], ["やまりゅう", 0], ["よしみね", 0], ["わかさ", 0]]
], [
[["いちもんじ", 0], ["いっきゅう", 2], ["いでいし", 0], ["いの", 0], ["いりきいん", 0], ["いわと", 2], ["おきちゃん", 0], ["かきがわ", 1], ["かつたけ", 0], ["かわかみ", 1], ["かわさき", 2], ["きとう", 0], ["くまた", 2], ["けいた", 0], ["こうのみや", 0], ["こが", 1], ["サキ", 2], ["さほ", 2], ["ししど", 2], ["シュリケン", 2], ["じん", 2], ["すずめ", 1], ["たけなか", 1], ["ツバサ", 0], ["つるた", 1], ["ティア", 2], ["とりはら", 2], ["ナベマン", 0], ["にいみ", 1], ["ニーヤ", 0], ["パンツ", 0], ["ふうらい", 2], ["ほそだ", 1], ["やじ", 1], ["やまふだ", 0], ["ゆめちよ", 2], ["らんばし", 1], ["わたなべ", 0]],
[["あおの", 2], ["うえすぎ", 2], ["うらた", 0], ["おばた", 1], ["かざきり", 1], ["かっちゃん", 0], ["カツノブ", 1], ["かみまる", 0], ["からまつ", 1], ["キラレア", 0], ["くない", 2], ["くらはし", 2], ["さかした", 1], ["さがら", 1], ["しもがわら", 2], ["すてふだ", 0], ["だいかく", 2], ["たかはら", 1], ["ちくま", 2], ["としぞう", 2], ["なかしま", 1], ["のぼりかわ", 2], ["のりまつ", 0], ["はやと", 0], ["はんだ", 2], ["ひうら", 0], ["ふじなみ", 1], ["ふるいち", 2], ["まんじ", 1], ["みあい", 0], ["ミルク", 0], ["むろう", 0], ["ゆうた", 0]],
[["いしげ", 2], ["いしつくり", 2], ["いわきやま", 0], ["うらしま", 1], ["おりた", 2], ["かいかわ", 2], ["かわしま", 2], ["キキ", 0], ["くさと", 0], ["こいま", 1], ["コトちゃん", 0], ["しあん", 0], ["しみず", 1], ["しもま", 1], ["しょうりん", 2], ["すいせん", 1], ["せいた", 0], ["そうじ", 2], ["たけば", 2], ["たびもと", 0], ["だるま", 0], ["なんば", 1], ["はとやま", 0], ["はなぞの", 1], ["はなだ", 1], ["ひね", 1], ["ふくおか", 1], ["ゆうぎり", 0], ["よしみ", 0], ["よしもと", 2], ["リュウ", 0], ["わたつみ", 2], ["わたや", 1]]
], [
[["アップル", 2], ["あめひこ", 2], ["いがわ", 1], ["いしくら", 2], ["いしだ", 0], ["いなば", 0], ["うりゅう", 1], ["きゅうじ", 2], ["くにたち", 1], ["くれない", 1], ["げんじ", 0], ["こうどう", 1], ["ゴショウ", 2], ["しずおか", 1], ["しらみね", 2], ["そま", 0], ["そらい", 1], ["たいら", 2], ["だて", 1], ["たねだ", 0], ["つぐみ", 0], ["なかやま", 2], ["ぬりたに", 0], ["ねむこ", 0], ["のいえ", 0], ["はいたに", 1], ["ひーくん", 0], ["ひろせ", 1], ["ほりえ", 0], ["まお", 0], ["まつだ", 1], ["やまがた", 2], ["ようすけ", 2], ["らじょう", 2]],
[["あいちゃん", 0], ["あかばね", 0], ["いいたに", 0], ["いわさわ", 1], ["オオカミ", 0], ["おおくぼ", 2], ["おしい", 2], ["かつお", 2], ["かわたか", 2], ["こより", 0], ["さいばら", 2], ["ささぶえ", 0], ["さた", 0], ["さだおか", 1], ["さるわたり", 2], ["しえり", 2], ["じぞう", 2], ["だいふく", 1], ["たかつ", 0], ["とおやま", 2], ["なかお", 0], ["はかた", 1], ["ヒコ", 1], ["びしゃもん", 1], ["まちだ", 1], ["みくに", 2], ["みつしま", 1], ["みと", 1], ["もとき", 0], ["もりや", 0], ["やすかわ", 0], ["やまひこ", 1], ["よねざわ", 1], ["ルチャ", 2]],
[["あぐち", 0], ["あまみや", 1], ["いそ", 0], ["いもと", 0], ["うづき", 2], ["うどう", 0], ["えのきど", 1], ["おおみち", 1], ["おぎの", 2], ["かおてつ", 2], ["かつらもと", 0], ["かねざわ", 2], ["からす", 1], ["きしかわ", 2], ["きたはら", 1], ["こうもと", 1], ["じんの", 2], ["たすけ", 2], ["たもと", 0], ["ちどり", 0], ["ちょうの", 2], ["てんねん", 0], ["なるたき", 1], ["にしはら", 0], ["はだ", 1], ["ふきこし", 2], ["プリンス", 1], ["ベルリン", 0], ["ほうらい", 1], ["まつおか", 1], ["もうり", 2], ["もちづき", 0]]
], [
[["あいこう", 1], ["あく", 1], ["いまざき", 2], ["いもこ", 1], ["いるか", 1], ["いわさ", 1], ["うえだ", 2], ["うらかた", 1], ["えりさ", 0], ["おうだ", 2], ["おしお", 0], ["からさき", 2], ["ぎんわ", 0], ["こうせい", 1], ["サッシー", 0], ["さめじま", 2], ["さらさ", 1], ["しげた", 1], ["しちや", 2], ["しれい", 0], ["しわす", 2], ["スナイパー", 0], ["たらみ", 1], ["ちのう", 0], ["トーテム", 0], ["パズル", 2], ["ふじわら", 1], ["ふみお", 2], ["ままだ", 0], ["メンカウラ", 2], ["やのうら", 0], ["ゆきやま", 2], ["ろぼてくす", 0]],
[["あさくぼ", 0], ["あさくら", 1], ["あさり", 0], ["ありさわ", 2], ["いで", 0], ["いぬい", 2], ["いぬはら", 1], ["おおね", 1], ["おきた", 2], ["かずお", 2], ["かずみち", 1], ["くまもと", 1], ["ごう", 2], ["ごぼう", 2], ["さいとう", 1], ["じみち", 1], ["じゅろう", 0], ["じょうほう", 0], ["ぜにがた", 2], ["だいまる", 2], ["たくま", 0], ["とうそう", 0], ["とっとり", 1], ["トマホーク", 2], ["ながおさ", 2], ["パウワウ", 0], ["ハウンド", 0], ["ふでた", 1], ["まきば", 2], ["やくしま", 1], ["ゆあさ", 1], ["よだ", 0], ["ロンリー", 0]],
[["いせ", 0], ["うただ", 2], ["おぐら", 1], ["おぬき", 0], ["カフラー", 2], ["きざむ", 1], ["クール", 2], ["くどう", 1], ["こしき", 1], ["さいうん", 2], ["さたけ", 0], ["しらぎく", 2], ["だんだ", 1], ["たんてい", 1], ["てみず", 1], ["とうけい", 0], ["とくなが", 0], ["とびひろ", 0], ["ドラム", 2], ["ながと", 2], ["ななせ", 0], ["なんの", 1], ["ひいろ", 0], ["ひきゃく", 1], ["ひでじま", 1], ["ふくし", 2], ["へいたい", 0], ["まえぞの", 2], ["まつうら", 1], ["まりむ", 2], ["らっかさん", 0], ["ランタン", 0], ["わかいずみ", 2], ["わんちゃん", 0]]
], [
[["あえん", 2], ["あだしの", 1], ["えつま", 1], ["エルザ", 2], ["おおたみ", 0], ["かどがみ", 1], ["かめい", 1], ["かわら", 0], ["くさべ", 1], ["さえり", 2], ["させ", 0], ["すいせい", 2], ["せいぎ", 2], ["そうざい", 1], ["だいだ", 0], ["タカ", 2], ["たまだ", 1], ["てつきた", 0], ["といかわ", 1], ["なると", 2], ["にんじん", 1], ["ハイネ", 0], ["ブッチー", 2], ["ほった", 1], ["ほんごう", 2], ["マミー", 0], ["みやなが", 0], ["むつやま", 1], ["もがみ", 0], ["やまだ", 2], ["やよい", 2], ["わくい", 0]],
[["あかい", 2], ["いのう", 2], ["いんぽう", 1], ["おおいし", 1], ["おくいずみ", 0], ["かねこ", 2], ["かべ", 1], ["くみむら", 0], ["くめ", 1], ["けいら", 1], ["ケンタ", 2], ["こでら", 2], ["こまつ", 2], ["ただ", 0], ["たのくら", 0], ["たまがわ", 2], ["ちべ", 1], ["とおるがわ", 0], ["としあき", 1], ["ながくら", 0], ["ながさか", 0], ["なや", 2], ["ひじり", 0], ["ひとみ", 0], ["マイカ", 2], ["むらこし", 2], ["やいと", 2], ["ゆたか", 1], ["よしおか", 1], ["りょう", 1]],
[["あらき", 0], ["いがしら", 2], ["イトー", 1], ["えひめ", 1], ["かみずる", 0], ["かんじや", 1], ["こいずみ", 1], ["こさか", 0], ["さおり", 2], ["しおざき", 1], ["じゆう", 0], ["すがわら", 1], ["すなご", 2], ["ぜんすい", 0], ["そうの", 2], ["つねや", 2], ["てんざん", 1], ["とくしま", 1], ["ながた", 1], ["なっちゃん", 0], ["のと", 0], ["パワー", 2], ["ひがし", 2], ["ひさもと", 0], ["ひらもと", 2], ["まるお", 0], ["みき", 1], ["ゆぐち", 2], ["よこやま", 0], ["よしなが", 1], ["りさ", 2]]
], [
[["あらかわ", 1], ["あらや", 1], ["アリエス", 2], ["いしはら", 1], ["うしまど", 0], ["うなぎ", 1], ["おおしか", 0], ["おおまさ", 1], ["おのだ", 1], ["さかきばら", 1], ["さごじょう", 2], ["しばふ", 2], ["しもや", 0], ["シンシン", 0], ["せつか", 0], ["そうくん", 2], ["そうだ", 2], ["ながの", 1], ["なるみ", 1], ["のえみ", 0], ["はまさき", 2], ["ひがさ", 0], ["ふかお", 2], ["ふじむら", 1], ["ほてい", 2], ["むそう", 0], ["やしろ", 0], ["やつだ", 1], ["やまおか", 2], ["やまざき", 0], ["ゆみ", 2], ["ようへい", 1], ["よし", 0], ["りんのうじ", 0], ["レオ", 2], ["ローマ", 2]],
[["アキ", 1], ["あべしま", 2], ["えきみち", 2], ["おおだか", 1], ["おおばやし", 1], ["かつら", 1], ["こおりやま", 1], ["ことは", 0], ["サーカス", 2], ["スカル", 2], ["スコピウス", 2], ["せいりょう", 1], ["タクマ", 1], ["ちはら", 0], ["ちょうくん", 2], ["てしま", 0], ["てらの", 2], ["とうじょう", 0], ["とき", 0], ["とちぎ", 2], ["とりやま", 0], ["なみえ", 0], ["にしじま", 2], ["はつしば", 1], ["はなぶき", 0], ["ひが", 1], ["ピスケス", 2], ["ふだな", 1], ["ふるはた", 1], ["ほそい", 2], ["ほりき", 1], ["ほりぐち", 0], ["ポルテ", 2], ["ますかわ", 0], ["まつたに", 0], ["わかば", 0]],
[["あんどう", 1], ["いたばし", 1], ["いちまつ", 1], ["いわぶち", 1], ["えいゆう", 1], ["おんだ", 2], ["ぎふ", 2], ["クラウン", 0], ["くりやま", 1], ["くろまじょ", 0], ["こうめい", 0], ["サジタリ", 2], ["しまぶくろ", 1], ["せいら", 0], ["せきぐち", 1], ["タウルス", 2], ["ちひろ", 1], ["チュール", 2], ["ちょうせん", 2], ["にむら", 0], ["ねお", 2], ["はしらたに", 1], ["はっかい", 2], ["ピエロン", 0], ["ひとやなぎ", 0], ["ひろあき", 1], ["フィレン", 2], ["ふくかわ", 0], ["ぷりん", 2], ["へりかわ", 0], ["マトりん", 0], ["メアリー", 0], ["ユウト", 0], ["よしかわ", 0], ["らもと", 2], ["りゅうこう", 1], ["りゅうび", 2]]
], [
[["あかえ", 2], ["いわて", 1], ["うらべ", 2], ["おがさわら", 0], ["おさかべ", 1], ["くぼた", 1], ["こうこ", 2], ["こえの", 0], ["コーヒー", 2], ["こにし", 1], ["さらやま", 0], ["しが", 2], ["すだ", 2], ["たいが", 0], ["たかさわ", 1], ["たちばな", 0], ["たまつき", 1], ["つかざき", 2], ["てるかわ", 0], ["どうき", 2], ["ななほし", 1], ["ニャア", 0], ["ぬのはら", 1], ["ねりやま", 1], ["のじま", 0], ["パーム", 2], ["ファイル", 0], ["ふくしま", 2], ["ふじもと", 0], ["ふやま", 2], ["やもり", 1], ["よしたけ", 0], ["りゅうよう", 0]],
[["あおもり", 1], ["あきもと", 0], ["あべ", 2], ["あまかわ", 1], ["いでた", 2], ["いぬがみ", 1], ["いわた", 1], ["いわなが", 2], ["おくむら", 1], ["ぎんはい", 2], ["くろまめ", 2], ["ゴーグル", 2], ["ごくき", 2], ["ごみ", 1], ["しだ", 2], ["しょうじ", 1], ["そとやま", 0], ["だいがみ", 0], ["たけがみ", 0], ["たにき", 0], ["つかもと", 0], ["てっぺい", 0], ["ときえだ", 1], ["なぎなた", 2], ["にしい", 0], ["はしぐち", 0], ["パック", 0], ["ひぐち", 2], ["ピラルク", 0], ["まほうじん", 0], ["ゆかこ", 0], ["ゆさ", 1], ["ラリー", 2]],
[["あんこう", 1], ["いなみ", 2], ["いのまた", 0], ["いまがわ", 0], ["いんの", 1], ["うしはら", 1], ["うばがい", 2], ["おいずみ", 2], ["おうぎや", 1], ["おかだ", 1], ["おかの", 1], ["カード", 0], ["こうりき", 2], ["こながわ", 1], ["さくらい", 1], ["シデン", 0], ["シャケ", 2], ["じょうき", 2], ["スーパー", 2], ["だんの", 0], ["ちさか", 0], ["てんき", 2], ["なかと", 0], ["なかはら", 0], ["なんぶ", 2], ["にいがた", 1], ["にしや", 0], ["のろい", 0], ["パッション", 0], ["ひらいわ", 0], ["ふるふみ", 0], ["ボニー", 2], ["みきお", 2], ["みちる", 2], ["むくお", 1]]
], [
[["いえなが", 0], ["うえさか", 1], ["かた", 1], ["カワセミ", 1], ["きつつき", 1], ["げんぶ", 2], ["こいけ", 1], ["こまがた", 0], ["すえひさ", 1], ["せいりゅう", 2], ["セマイ", 0], ["ちば", 1], ["はくさん", 0], ["まさおか", 0], ["まるわ", 1], ["みやぎ", 2]],
[["アコ", 2], ["うだがわ", 1], ["うみかわ", 1], ["かさい", 0], ["かたやま", 1], ["かみきり", 2], ["きしき", 0], ["ぐんま", 1], ["すざく", 2], ["すじはら", 1], ["たじ", 0], ["たつみ", 1], ["たど", 0], ["とうきょう", 1], ["ひらまつ", 0], ["フェズ", 0], ["ほしみ", 1], ["もりたき", 0], ["わかやま", 1]],
[["あすか", 1], ["いみず", 0], ["うすだ", 1], ["かんだ", 1], ["くわはら", 1], ["ケート", 0], ["さやま", 0], ["しゅん", 1], ["たて", 2], ["なかね", 0], ["にしむら", 0], ["びゃっこ", 2], ["ふくつ", 1], ["みぶ", 1]]
]
];

addEvent(window, "load", function() {
	var form = document.forms.f;
	addEvent(form, "submit", submit_callback(on_submit));
	addEvent(form.elements.delete_button, "click", function() {
		document.getElementById("result").innerHTML = "";
	});
	addEvent(get_elem_by_tag_and_class(form, "td", "machine-area"), "click", update_candidate_check);
	addEvent(get_elem_by_tag_and_class(form, "td", "color-area"), "click", update_candidate_check);
	update_candidate_check();
	addEvent(form.elements.reverse_candidate_check, "click", reverse_candidate_check);
	addEvent(form.elements.load_candidate_check, "click", load_candidate_check);
	addEvent(form.elements.save_candidate_check, "click", save_candidate_check);
});

function update_candidate_check() {
	var form = document.forms.f;
	var machine_no = Number(get_checked_radio_value(form.elements.machine));
	var color = Number(get_checked_radio_value(form.elements.color));
	var area = get_elem_by_tag_and_class(form, "td", "candidate-check-area");
	var buf = "";
	var units = CAPSULE_UNIT_DATA[machine_no][color];
	for (var i = 0; i < units.length; i ++) {
		var name = units[i][0];
		buf += '<label><input type="checkbox" name="unit-enabled-'+i+'">'+name+'</label><br>';
	}
	area.innerHTML = buf;
}

function reverse_candidate_check() {
	var form = document.forms.f;
	var i = 0;
	while (true) {
		var checkbox = form.elements["unit-enabled-"+i];
		if (!checkbox) break;
		checkbox.checked = !checkbox.checked;
		i ++;
	}
}

function load_candidate_check() {
	var form = document.forms.f;
	var textarea = form.elements.candidate_check_text;
	var val = textarea.value.match(/[01]/g);
	
	for (var i = 0; i < val.length; i ++) {
		var checkbox = form.elements["unit-enabled-"+i];
		if (!checkbox) break;
		checkbox.checked = val[i] !== "0";
	}
}

function save_candidate_check() {
	var form = document.forms.f;
	var textarea = form.elements.candidate_check_text;
	var buf = "";
	
	var i = 0;
	while (true) {
		var checkbox = form.elements["unit-enabled-"+i];
		if (!checkbox) break;
		buf += checkbox.checked ? "1" : "0";
		i ++;
	}
	textarea.value = buf;
}

function on_submit(form) {
	var f = form.elements;
	var fseed = read_input(f.fseed, "初期seed");
	var result_max = read_input(f.result_max, "出力個数");
	var machine_no = Number(get_checked_radio_value(f.machine));
	var color = Number(get_checked_radio_value(f.color));
	
	var candidates_all = CAPSULE_UNIT_DATA[machine_no][color];
	var candidate_enabled = read_candidate_enabled(form, candidates_all.length);
	var candidates = filter_candidates(candidates_all, candidate_enabled);
	
	var method = get_checked_radio_value(f.method);
	
	
	var result_area = document.getElementById("result");
	var buf = "";
	
	var chooser = new CapsuleChooser(candidates);
	if (method === "advancemnet-number") {
		var output_advancement = read_input_re(f.output_advancement, /^(\d+)n\+(\d+)$/, "出力する消費値");
		var advancement_step = Number(output_advancement[1]);
		var advancement_init = Number(output_advancement[2])
		buf += "<table><tr><th>No<th>消費<th>結果";
		
		var prng = new PRNG32bit(fseed);
		var advancement = advancement_init;
		prng.step(advancement);
		for (var i = 0; i < result_max; i ++) {
			var name = chooser.choose(prng.clone());
			buf += "<tr><td>"+i+"<td>"+advancement+"<td>"+name;
			prng.step(advancement_step);
			advancement += advancement_step;
		}
	} else {
		buf += "<p><small>表の位置とガチャの選手は「これまで○回質問を開いた」ときに出る値です。すなわち、目的のガチャの選手が出る回数が x のとき x-1 の行の「表の位置」が出たところで終了です。</small></p>";
		buf += "<table><tr><th>回数<th>消費<th>表の位置<th>ガチャの選手";
		var prng = new PRNG32bit(fseed);
		var advancement = 1;
		prng.step(advancement);
		var prev_x = 0, prev_y = 0;
		for (var i = 0; i < result_max; i ++) {
			var r = calc_movielink_table_pos(prng.clone(), prev_x, prev_y);
			prev_x = r.x, prev_y = r.y;
			var name = chooser.choose(prng.clone());
			buf += "<tr><td>"+i+"<td>"+advancement+"<td>"+stringify_movielink_table_pos(r.x, r.y)+"<td>"+name;
			prng.step(r.advancement);
			advancement += r.advancement;
		}
	}
	result_area.innerHTML = buf;
}

function read_candidate_enabled(form, len) {
	var result = new Array(len);
	for (var i = 0; i < len; i ++) {
		result[i] = form.elements["unit-enabled-"+i].checked;
	}
	return result;
}

function filter_candidates(candidates, enabled) {
	var result = [];
	for (var i = 0; i < candidates.length; i ++) {
		if (enabled[i]) {
			result.push(candidates[i]);
		}
	}
	return result;
}

function calc_movielink_table_pos(prng, prev_x, prev_y) {
	var x, y;
	var advancement = 0;
	do {
		y = prng.rand() % 6;
		advancement ++;
	} while(y === prev_y);
	do {
		x = prng.rand() % 8;
		advancement ++;
	} while(x === prev_x);
	
	
	advancement ++; // 何に使われているか不明の1消費
	return {x: x, y: y, advancement: advancement};
}

function stringify_movielink_table_pos(x, y) {
	var xtable = "ABCDEFGH";
	return String(y + 1) + "-" + xtable.charAt(x);
}

function CapsuleChooser(candidates) {
	this.candidates = fix_candidates(candidates);
	this.sum = count_unit_odds(this.candidates);
}

CapsuleChooser.prototype.choose = function(prng) {
	var val = prng.rand() % this.sum;
	var sum = 0;
	var candidates = this.candidates;
	for (var i = 0; i < candidates.length; i ++) {
		var name = candidates[i][0], odd = to_unit_odd(candidates[i][1]);
		sum += odd;
		if (sum > val) {
			return name;
		}
	}
};

function to_unit_odd(rare_degree) {
	switch (rare_degree) {
	case 0: return 60;
	case 1: return 30;
	case 2: return 10;
	}
	throw "UNREACHABLE";
}

function fix_candidates(candidates) {
	var result = array_copy(candidates);
	var blank = ["はずれ", 1];
	while (result.length < 7) {
		result.push(blank);
	}
	return result;
}

function count_unit_odds(candidates) {
	var sum = 0;
	for (var i = 0; i < candidates.length; i ++) {
		var rare_degree = candidates[i][1];
		sum += to_unit_odd(rare_degree);
	}
	return sum;
}

function PRNG32bit(seed) {
	this.seed = seed;
}

PRNG32bit.A = 0x41c64e6d;
PRNG32bit.B = 0x00003039;

PRNG32bit.prototype.clone = function() {
	return new PRNG32bit(this.seed);
}

PRNG32bit.prototype.rand = function() {
	this.seed = u32_mul(this.seed, PRNG32bit.A) + PRNG32bit.B >>> 0;
	return this.seed >> 16 & 0x7fff;
};

PRNG32bit.prototype.step = function(n) {
	var a = PRNG32bit.A;
	var b = PRNG32bit.B;
	while (true) {
		if (n & 1) {
			this.seed = u32_mul(this.seed, a) + b >>> 0;
		}
		n >>>= 1;
		if (n === 0) break;
		b = u32_mul(b, a) + b >>> 0;
		a = u32_mul(a, a) >>> 0;
	}
};

function u32_mul(a, b) {
	var a1 = a >>> 16, a2 = a & 0xffff;
	var b1 = b >>> 16, b2 = b & 0xffff;
	return (((a1 * b2 + a2 * b1) << 16) + a2 * b2) >>> 0;
}

</script>
<style type="text/css">
form {
	margin-bottom: 1em;
}

table {
	border-collapse: collapse;
	font-size: 80%;
	margin: 0;
}

p {
	margin: 0.5em 0;
}

th, td {
	padding: 0.1em 5px;
	border: 1px solid black;
}

th {
	background: #ddd;
}

form table {
	font-size: 100%;
	margin: 0;
}

form th {
	text-align: right;
	vertical-align: top;
	background: transparent;
}

form th,
form td {
	border: none;
}

table.for-layout {
	font-size: 100%;
	margin: 0;
	padding: 0;
}

table.for-layout > * > tr > th,
table.for-layout > * > tr > td {
	border: none;
	margin: 0;
	vertical-align: top;
}
</style>
</head>
<body>
<h1>イナズマ3 ガチャ</h1>
<ul>
<li>乱数はタイトル画面（はじめから、つづきから、つうしんが並んでいる画面）で初期化されます
<li>初期seedはMACアドレスの2つ目と6つ目を掛けた値になります (例: 12-34-56-78-9A-BC なら 0x34 * 0xbc = 9776)
<li>MACアドレスはタイトル画面＞つうしん＞Wi-Fi せってい＞オプション＞本体情報から確認できます
<li>乱数が初期化されたときに最初に必ず1消費されます
<li>ガチャマシンで回すと（どの選手になるかの決定に使われる消費も合わせて）3つ消費します
<li>劇場版連動で1つ質問が出るたびに乱数が消費されます。これを使って消費を調整することができます
</ul>
<h2>リスト作成</h2>
<form action="" name="f" onsubmit="return false;" autocomplete="off">
<table>
<tr><th>マシン:<td class="machine-area">
<label><input type="radio" name="machine" value="0" checked>01号 (稲妻商店街)</label><br>
<label><input type="radio" name="machine" value="1">02号 (大江戸国際空港)</label><br>
<label><input type="radio" name="machine" value="2">03号 (北海道)</label><br>
<label><input type="radio" name="machine" value="3">04号 (大阪など関西 愛媛)</label><br>
<label><input type="radio" name="machine" value="4">05号 (福岡 沖縄)</label><br>
<label><input type="radio" name="machine" value="5">06号 (ジャパンエリア)</label><br>
<label><input type="radio" name="machine" value="6">07号 (イギリスエリア)</label><br>
<label><input type="radio" name="machine" value="7">08号 (アルゼンチンエリア)</label><br>
<label><input type="radio" name="machine" value="8">09号 (アメリカエリア)</label><br>
<label><input type="radio" name="machine" value="9">10号 (イタリアエリア)</label><br>
<label><input type="radio" name="machine" value="10">11号 (ブラジルエリア)</label><br>
<label><input type="radio" name="machine" value="11">12号 (コトアールエリア)</label>
<tr><th>コイン:<td class="color-area">
<label><input type="radio" name="color" value="0" checked>赤</label>
<label><input type="radio" name="color" value="1">青</label>
<label><input type="radio" name="color" value="2">黄</label>
<tr><th>選手:<td>出る可能性のある (バインダーに登録されていて仲間になっていない) 選手にチェック
<table class="for-layout">
<tr><td class="candidate-check-area"><td>
補助<br>
<input type="button" name="reverse_candidate_check" value="チェックを反転"><br>
<table class="for-layout">
<tr><td><input type="button" name="load_candidate_check" value="←"><br><input type="button" name="save_candidate_check" value="→">
<td><textarea cols="50" rows="2" name="candidate_check_text"></textarea>
</table>
</table>
<tr><th>初期seed:<td><input type="text" size="20" name="fseed" value="">
<tr><th>出力個数:<td><input type="text" size="6" name="result_max" value="100">
<tr><th>出力<td>
<label><input type="radio" name="method" value="count-movielink" checked>劇場版連動の質問を開いた回数で出力</label><br>
<label><input type="radio" name="method" value="advancemnet-number">消費数で出力</label> <input type="text" size="8" name="output_advancement" value="3n+1">
<tr><td><td><input type="submit" value="決定"> <input type="button" name="delete_button" value="結果を消す">
</table>
</form>
<div id="result"></div>

</body>
</html>
